(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30980,        796]
NotebookOptionsPosition[     29715,        747]
NotebookOutlinePosition[     30091,        763]
CellTagsIndexPosition[     30048,        760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Calculate the tangent points from (0,0) to an ellipse (a,b) at (X0,Y0)\
\>", "Section",
 CellChangeTimes->{{3.768196557660877*^9, 3.768196589360133*^9}, {
  3.7684563352026854`*^9, 3.768456348587509*^9}}],

Cell[TextData[{
 "Tangents ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "X0"}], ")"}], "2"], "/", 
     SuperscriptBox["a", "2"]}], "+", " ", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y", "-", "Y0"}], ")"}], "2"], "/", 
     SuperscriptBox["b", "2"]}]}], "\[Equal]", "1"}]],
  CellChangeTimes->{{3.768158678394843*^9, 3.768158822227095*^9}, {
    3.7681588627871666`*^9, 3.768158968868353*^9}, {3.7681590103644257`*^9, 
    3.7681591922139454`*^9}, {3.7681593429102097`*^9, 
    3.7681593681510544`*^9}, {3.7681596179240932`*^9, 3.7681596573921623`*^9},
     3.768159762661147*^9, {3.7681600366810427`*^9, 3.768160042203452*^9}, {
    3.7681601039483604`*^9, 3.76816010925237*^9}, {3.768192896329399*^9, 
    3.7681929331610637`*^9}, {3.768192977215541*^9, 3.768192995030772*^9}, {
    3.7681930763735223`*^9, 3.768193105951174*^9}, {3.7681933026363196`*^9, 
    3.768193309266331*^9}, 3.768193351464405*^9, {3.7681933941304803`*^9, 
    3.7681934712414155`*^9}, 3.768193550473955*^9, {3.7681935910652266`*^9, 
    3.7681935931712303`*^9}, {3.768194040112015*^9, 3.7681940477872286`*^9}, {
    3.768194100577721*^9, 3.768194101700923*^9}, {3.768194430783501*^9, 
    3.7681945155384502`*^9}, {3.768194687637952*^9, 3.7681947030507793`*^9}, {
    3.7681947340012336`*^9, 3.768194758524477*^9}, {3.7681947976181455`*^9, 
    3.7681948311426044`*^9}, 3.768194940741405*^9, {3.7681949820190773`*^9, 
    3.768195021253146*^9}, {3.768195064886423*^9, 3.7681951034808908`*^9}, {
    3.7681951451485643`*^9, 3.768195328119294*^9}, {3.768195433013878*^9, 
    3.768195490499979*^9}, {3.7681956068137836`*^9, 3.7681956202162075`*^9}, {
    3.7681957111399903`*^9, 3.768195723885213*^9}, {3.768195814958173*^9, 
    3.7681958239125886`*^9}, {3.768195963751234*^9, 3.7681960624214077`*^9}}],
 " should have a slope ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"dy", "/", "dx"}], "=", "m"}]],
  CellChangeTimes->{{3.768158678394843*^9, 3.768158822227095*^9}, {
    3.7681588627871666`*^9, 3.768158968868353*^9}, {3.7681590103644257`*^9, 
    3.7681591922139454`*^9}, {3.7681593429102097`*^9, 
    3.7681593681510544`*^9}, {3.7681596179240932`*^9, 3.7681596573921623`*^9},
     3.768159762661147*^9, {3.7681600366810427`*^9, 3.768160042203452*^9}, {
    3.7681601039483604`*^9, 3.76816010925237*^9}, {3.768192896329399*^9, 
    3.7681929331610637`*^9}, {3.768192977215541*^9, 3.768192995030772*^9}, {
    3.7681930763735223`*^9, 3.768193105951174*^9}, {3.7681933026363196`*^9, 
    3.768193309266331*^9}, 3.768193351464405*^9, {3.7681933941304803`*^9, 
    3.7681934712414155`*^9}, 3.768193550473955*^9, {3.7681935910652266`*^9, 
    3.7681935931712303`*^9}, {3.768194040112015*^9, 3.7681940477872286`*^9}, {
    3.768194100577721*^9, 3.768194101700923*^9}, {3.768194430783501*^9, 
    3.7681945155384502`*^9}, {3.768194687637952*^9, 3.7681947030507793`*^9}, {
    3.7681947340012336`*^9, 3.768194758524477*^9}, {3.7681947976181455`*^9, 
    3.7681948311426044`*^9}, 3.768194940741405*^9, {3.7681949820190773`*^9, 
    3.768195021253146*^9}, {3.768195064886423*^9, 3.7681951034808908`*^9}, {
    3.7681951451485643`*^9, 3.768195328119294*^9}, {3.768195433013878*^9, 
    3.768195490499979*^9}, {3.7681956068137836`*^9, 3.7681956202162075`*^9}, {
    3.7681957111399903`*^9, 3.768195723885213*^9}, {3.768195814958173*^9, 
    3.7681958239125886`*^9}, {3.768195963751234*^9, 3.7681960624214077`*^9}}],
 " ."
}], "Text",
 CellChangeTimes->{{3.7684563611923313`*^9, 3.7684563924859867`*^9}, {
  3.768456460673706*^9, 3.7684564939017644`*^9}, {3.7684565369296403`*^9, 
  3.768456546898058*^9}, {3.7684565900477333`*^9, 3.7684565980973473`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X0"}], ")"}], "2"], "/", 
         SuperscriptBox["a", "2"]}], ",", "x"}], "]"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y", "-", "Y0"}], ")"}], "2"], "/", 
          SuperscriptBox["b", "2"]}], ",", "y"}], "]"}], "m"}]}], ")"}], "/", 
    "2"}], "//", "Expand"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.768195506536807*^9, 3.7681956018997746`*^9}, {
  3.768195700578772*^9, 3.768195707115184*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"x", "-", "X0"}], 
   SuperscriptBox["a", "2"]], "+", 
  FractionBox[
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{"y", "-", "Y0"}], ")"}]}], 
   SuperscriptBox["b", "2"]]}]], "Output",
 CellChangeTimes->{{3.768195548422881*^9, 3.768195628849846*^9}, 
   3.7681957247432146`*^9, 3.7681959479172063`*^9, {3.768196114650299*^9, 
   3.768196131607529*^9}, 3.768196370256748*^9, {3.768196464605714*^9, 
   3.7681964904237595`*^9}, 3.7684563111786437`*^9, 3.768456603713358*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol$", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "/.", 
    RowBox[{"Solve", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"x", "-", "X0"}], 
           SuperscriptBox["a", "2"]], "+", 
          FractionBox[
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"y", "-", "Y0"}], ")"}]}], 
           SuperscriptBox["b", "2"]]}], "\[Equal]", "0"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "m", " ", "is", " ", "the", " ", "slope", " ", "of", " ", "the", " ",
           "tangent"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"m", "\[Equal]", 
         RowBox[{"y", "/", "x"}]}], ",", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Line", " ", "through", " ", 
          RowBox[{"(", 
           RowBox[{"0", ",", "0"}], ")"}], " ", "with", " ", "the", " ", 
          "slope", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "X0"}], ")"}], "2"], "/", 
           SuperscriptBox["a", "2"]}], "+", " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "Y0"}], ")"}], "2"], "/", 
           SuperscriptBox["b", "2"]}]}], "\[Equal]", "1"}]}], "  ", 
       RowBox[{"(*", " ", "Ellipse", " ", "*)"}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "m"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], "//", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", ">", "0"}], "&&", 
         RowBox[{"b", ">", "0"}], "&&", 
         RowBox[{"X0", ">", "0"}], "&&", 
         RowBox[{"Y0", ">", "0"}]}], "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.768158678394843*^9, 3.768158822227095*^9}, {
   3.7681588627871666`*^9, 3.768158968868353*^9}, {3.7681590103644257`*^9, 
   3.7681591922139454`*^9}, {3.7681593429102097`*^9, 
   3.7681593681510544`*^9}, {3.7681596179240932`*^9, 3.7681596573921623`*^9}, 
   3.768159762661147*^9, {3.7681600366810427`*^9, 3.768160042203452*^9}, {
   3.7681601039483604`*^9, 3.76816010925237*^9}, {3.768192896329399*^9, 
   3.7681929331610637`*^9}, {3.768192977215541*^9, 3.768192995030772*^9}, {
   3.7681930763735223`*^9, 3.768193105951174*^9}, {3.7681933026363196`*^9, 
   3.768193309266331*^9}, 3.768193351464405*^9, {3.7681933941304803`*^9, 
   3.7681934712414155`*^9}, 3.768193550473955*^9, {3.7681935910652266`*^9, 
   3.7681935931712303`*^9}, {3.768194040112015*^9, 3.7681940477872286`*^9}, {
   3.768194100577721*^9, 3.768194101700923*^9}, {3.768194430783501*^9, 
   3.7681945155384502`*^9}, {3.768194687637952*^9, 3.7681947030507793`*^9}, {
   3.7681947340012336`*^9, 3.768194758524477*^9}, {3.7681947976181455`*^9, 
   3.7681948311426044`*^9}, 3.768194940741405*^9, {3.7681949820190773`*^9, 
   3.768195021253146*^9}, {3.768195064886423*^9, 3.7681951034808908`*^9}, {
   3.7681951451485643`*^9, 3.768195328119294*^9}, {3.768195433013878*^9, 
   3.768195490499979*^9}, {3.7681956068137836`*^9, 3.7681956202162075`*^9}, {
   3.7681957111399903`*^9, 3.768195723885213*^9}, {3.768195814958173*^9, 
   3.7681958239125886`*^9}, {3.768195963751234*^9, 3.7681960624214077`*^9}, {
   3.7684564319852557`*^9, 3.76845644596288*^9}, {3.7684565014833775`*^9, 
   3.7684565160694036`*^9}, {3.7684565490196614`*^9, 3.768456583870123*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "3"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], " ", "X0"}], "+", 
          RowBox[{"Y0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"X0", " ", "Y0"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["X0", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["b", "2"]}], "+", 
                  SuperscriptBox["Y0", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["Y0", "2"]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], " ", "Y0"}], "+", 
          SuperscriptBox["Y0", "3"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "X0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X0", " ", "Y0"}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["X0", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["b", "2"]}], "+", 
               SuperscriptBox["Y0", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["Y0", "2"]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "3"]}], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "2"], " ", "X0"}], "+", 
          RowBox[{"Y0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "X0"}], " ", "Y0"}], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["X0", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["b", "2"]}], "+", 
                  SuperscriptBox["Y0", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["Y0", "2"]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], " ", "Y0"}], "+", 
          SuperscriptBox["Y0", "3"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "X0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X0", " ", "Y0"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["X0", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["b", "2"]}], "+", 
               SuperscriptBox["Y0", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["X0", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["Y0", "2"]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7681960588178015`*^9, 3.7681960628582087`*^9}, {
   3.7681961156487007`*^9, 3.768196132605931*^9}, 3.76819637127075*^9, {
   3.7681964656041155`*^9, 3.768196491422161*^9}, 3.7684563123642454`*^9, 
   3.768456604742959*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test plot", "Section",
 CellChangeTimes->{{3.7681965110469956`*^9, 3.7681965314840317`*^9}, {
  3.7684566161309795`*^9, 3.7684566172853813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "1"}], ",", 
     RowBox[{"b", "=", "0.5"}], ",", 
     RowBox[{"X0", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"Y0", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "sol$", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "-", 
        RowBox[{"{", 
         RowBox[{"X0", ",", "Y0"}], "}"}]}], "&"}], "/@", "sol$"}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"360", "+", 
        RowBox[{
         RowBox[{"180", "/", "\[Pi]"}], "*", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}]}]}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"{", 
           RowBox[{"X0", ",", "Y0"}], "}"}]}], "&"}], "/@", "sol$"}], ")"}]}],
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X0", ",", "Y0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{
          "sol$", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{
          "sol$", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.768195825815792*^9, 3.768195940460393*^9}, {
   3.7681975026569967`*^9, 3.768197514029417*^9}, {3.768197557397493*^9, 
   3.768197568629513*^9}, {3.768197602434772*^9, 3.7681976638676796`*^9}, 
   3.7681977376246095`*^9, {3.7681977699478664`*^9, 3.7681977743314743`*^9}, {
   3.768197812379941*^9, 3.768197887790473*^9}, {3.7681979723114214`*^9, 
   3.768197975712228*^9}, {3.7681980122640915`*^9, 3.7681980367249346`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.4920307293423574`", ",", "1.9370019205838973`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.430492267803896`"}], ",", "1.8168442332622567`"}], 
    "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.7681975128126144`*^9, 3.768197514528618*^9}, {
   3.7681975628107023`*^9, 3.7681975689727135`*^9}, {3.7681976274104156`*^9, 
   3.7681976647412815`*^9}, 3.7681977380458097`*^9, 3.7681977749866753`*^9, {
   3.768197814345544*^9, 3.768197888180474*^9}, {3.768197973075823*^9, 
   3.768197976663829*^9}, {3.7681980183793025`*^9, 3.7681980373021355`*^9}, 
   3.7684563125046463`*^9, 3.7684566047741594`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9920307293423574`", ",", 
     RowBox[{"-", "0.06299807941610269`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.930492267803896`"}], ",", 
     RowBox[{"-", "0.18315576673774325`"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.7681975128126144`*^9, 3.768197514528618*^9}, {
   3.7681975628107023`*^9, 3.7681975689727135`*^9}, {3.7681976274104156`*^9, 
   3.7681976647412815`*^9}, 3.7681977380458097`*^9, 3.7681977749866753`*^9, {
   3.768197814345544*^9, 3.768197888180474*^9}, {3.768197973075823*^9, 
   3.768197976663829*^9}, {3.7681980183793025`*^9, 3.7681980373021355`*^9}, 
   3.7684563125046463`*^9, 3.7684566047741594`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"356.3663588927446`", ",", "191.13559793575428`"}], "}"}]], "Print",
 CellChangeTimes->{{3.7681975128126144`*^9, 3.768197514528618*^9}, {
   3.7681975628107023`*^9, 3.7681975689727135`*^9}, {3.7681976274104156`*^9, 
   3.7681976647412815`*^9}, 3.7681977380458097`*^9, 3.7681977749866753`*^9, {
   3.768197814345544*^9, 3.768197888180474*^9}, {3.768197973075823*^9, 
   3.768197976663829*^9}, {3.7681980183793025`*^9, 3.7681980373021355`*^9}, 
   3.7684563125046463`*^9, 3.7684566047897596`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{CircleBox[{-0.5, 2}, {1., 0.5}], 
   LineBox[{{0, 0}, {0.4920307293423574, 1.9370019205838973`}}], 
   LineBox[{{0, 0}, {-1.430492267803896, 1.8168442332622567`}}]}]], "Output",
 CellChangeTimes->{
  3.7681958659546623`*^9, {3.7681958981687193`*^9, 3.768195948510008*^9}, {
   3.7681960042177052`*^9, 3.768196022407337*^9}, {3.7681961115458937`*^9, 
   3.7681961326371307`*^9}, 3.7681963712863503`*^9, {3.7681964656197157`*^9, 
   3.7681964914533615`*^9}, {3.7681975128126144`*^9, 3.768197514528618*^9}, {
   3.7681975628107023`*^9, 3.7681975689727135`*^9}, {3.7681976274104156`*^9, 
   3.7681976647412815`*^9}, 3.76819773806141*^9, 3.7681977749866753`*^9, {
   3.768197814345544*^9, 3.768197888196074*^9}, {3.768197973075823*^9, 
   3.768197976679429*^9}, {3.7681980183949027`*^9, 3.7681980373177357`*^9}, 
   3.7684563125046463`*^9, 3.7684566047897596`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Generate ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]]],
 " code for TikZ"
}], "Section",
 CellChangeTimes->{{3.7681965110469956`*^9, 3.7681965314840317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"texConvert", "[", "e_", "]"}], ":=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"ToString", "@", 
     RowBox[{"InputForm", "@", "e"}]}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<X0\>\"", "\[Rule]", "\"\<(#1)\>\""}], ",", 
      RowBox[{"\"\<Y0\>\"", "\[Rule]", "\"\<(#2)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<a\>\"", "\[Rule]", "\"\<#3\>\""}], ",", 
      RowBox[{"\"\<b\>\"", "\[Rule]", "\"\<#4\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
      RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PP\>\"", "\[Rule]", "\"\<(\\\\NCPP)\>\""}], ",", 
      RowBox[{"\"\<QQ\>\"", "\[Rule]", "\"\<(\\\\NCQQ)\>\""}], ",", 
      RowBox[{"\"\<RR\>\"", "\[Rule]", "\"\<(\\\\NCRR)\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7681929783699427`*^9, 3.768192988681561*^9}, {
  3.768193113860388*^9, 3.7681931773836994`*^9}, {3.76819331430514*^9, 
  3.768193315334742*^9}, {3.7681939177922*^9, 3.768193928400219*^9}, {
  3.76819441856868*^9, 3.768194453559541*^9}, {3.7681944979884195`*^9, 
  3.7681945306392765`*^9}, {3.768194740085244*^9, 3.768194741536047*^9}, {
  3.768196366153941*^9, 3.7681963689463463`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol2$", "=", 
  RowBox[{
   RowBox[{"sol$", "/.", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["X0", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["b", "2"]}], "+", 
            SuperscriptBox["Y0", "2"]}], ")"}]}]}]], "\[Rule]", "PP"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox["X0", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["Y0", "2"]}]}], "\[Rule]", "QQ"}]}], 
     "\[IndentingNewLine]", "}"}]}], "//", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["X0", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], "  ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["Y0", "2"]}], ")"}]}]}], "\[Equal]", "RR"}], 
        "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.768158678394843*^9, 3.768158822227095*^9}, {
   3.7681588627871666`*^9, 3.768158968868353*^9}, {3.7681590103644257`*^9, 
   3.7681591922139454`*^9}, {3.7681593429102097`*^9, 
   3.7681593681510544`*^9}, {3.7681596179240932`*^9, 3.7681596573921623`*^9}, 
   3.768159762661147*^9, {3.7681600366810427`*^9, 3.768160042203452*^9}, {
   3.7681601039483604`*^9, 3.76816010925237*^9}, {3.768192896329399*^9, 
   3.7681929331610637`*^9}, {3.768192977215541*^9, 3.768192995030772*^9}, {
   3.7681930763735223`*^9, 3.768193105951174*^9}, {3.7681933026363196`*^9, 
   3.768193309266331*^9}, 3.768193351464405*^9, {3.7681933941304803`*^9, 
   3.7681934712414155`*^9}, 3.768193550473955*^9, {3.7681935910652266`*^9, 
   3.7681935931712303`*^9}, {3.768194040112015*^9, 3.7681940477872286`*^9}, {
   3.768194100577721*^9, 3.768194101700923*^9}, {3.768194430783501*^9, 
   3.7681945155384502`*^9}, {3.768194687637952*^9, 3.7681947030507793`*^9}, {
   3.7681947340012336`*^9, 3.768194758524477*^9}, {3.7681947976181455`*^9, 
   3.7681948311426044`*^9}, 3.768194940741405*^9, {3.7681949820190773`*^9, 
   3.768195021253146*^9}, {3.768195064886423*^9, 3.7681951034808908`*^9}, {
   3.7681951451485643`*^9, 3.768195328119294*^9}, {3.768195433013878*^9, 
   3.768195490499979*^9}, {3.7681956068137836`*^9, 3.7681956202162075`*^9}, {
   3.7681957111399903`*^9, 3.768195723885213*^9}, {3.768195814958173*^9, 
   3.7681958239125886`*^9}, {3.768195963751234*^9, 3.768196090563857*^9}, 
   3.76819612649072*^9, {3.768196171449999*^9, 3.768196328074274*^9}, {
   3.7681963998188*^9, 3.7681964130476236`*^9}, 3.7681964893629575`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"RR", " ", "X0"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "PP", " ", "Y0"}]}], "QQ"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["b", "2"]}], " ", "PP", " ", "X0"}], "+", 
       RowBox[{"RR", " ", "Y0"}]}], "QQ"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"RR", " ", "X0"}], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "PP", " ", "Y0"}]}], "QQ"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", "PP", " ", "X0"}], "+", 
       RowBox[{"RR", " ", "Y0"}]}], "QQ"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7681950225947485`*^9, {3.768195072561637*^9, 3.768195115929713*^9}, {
   3.768195165116599*^9, 3.768195193571049*^9}, {3.7681952422129345`*^9, 
   3.768195288014615*^9}, 3.7681953290708957`*^9, {3.7681954440898976`*^9, 
   3.76819547365195*^9}, 3.768195609357588*^9, 3.7681957253048153`*^9, 
   3.7681958244585896`*^9, {3.7681959484944077`*^9, 3.768196132683931*^9}, {
   3.7681961734000025`*^9, 3.768196237219714*^9}, {3.768196279105788*^9, 
   3.7681963289946756`*^9}, 3.76819637133315*^9, {3.7681964035160065`*^9, 
   3.768196413671624*^9}, {3.768196465666516*^9, 3.768196491500161*^9}, 
   3.768456312551446*^9, 3.7684566048365593`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"texConvert", "/@", 
   RowBox[{"Flatten", "@", "sol2$"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<\\\\newcommand{\\\\ncCoords}[4]{\\n\>\"", "<>", 
  "\[IndentingNewLine]", "\"\<  \\\\def\\\\NCPP{ \>\"", "<>", 
  RowBox[{"texConvert", "[", 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      SuperscriptBox["X0", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["b", "2"]}], "+", 
        SuperscriptBox["Y0", "2"]}], ")"}]}]}]], "]"}], "<>", "\"\< }\\n\>\"",
   "<>", "\[IndentingNewLine]", "\"\<  \\\\def\\\\NCQQ{ ( \>\"", "<>", 
  RowBox[{"texConvert", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["b", "2"], " ", 
     SuperscriptBox["X0", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["Y0", "2"]}]}], "]"}], "<>", "\"\< ) }\\n\>\"", "<>", 
  "\[IndentingNewLine]", "\"\<  \\\\def\\\\NCRR{ ( \>\"", "<>", 
  RowBox[{"texConvert", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["b", "2"], " ", 
     SuperscriptBox["X0", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["b", "2"]}], "+", 
       SuperscriptBox["Y0", "2"]}], ")"}]}]}], "]"}], "<>", "\"\< ) }\\n\>\"",
   "<>", "\[IndentingNewLine]", "\"\<  \\\\def\\\\Xa{ \>\"", "<>", 
  RowBox[{"%", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<>", 
  "\"\< }\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<  \\\\def\\\\Xb{ \>\"", "<>", 
  RowBox[{"%", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "<>", 
  "\"\< }\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<  \\\\def\\\\Ya{ \>\"", "<>", 
  RowBox[{"%", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "<>", 
  "\"\< }\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<  \\\\def\\\\Yb{ \>\"", "<>", 
  RowBox[{"%", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "<>", 
  "\"\< }\\n}\>\""}]}], "Input",
 CellChangeTimes->{
  3.768196130609127*^9, {3.768196336092688*^9, 3.768196358073127*^9}, {
   3.7681964178836317`*^9, 3.768196453108494*^9}, {3.7684562627873583`*^9, 
   3.7684563098058414`*^9}}],

Cell[BoxData["\<\"\\\\newcommand{\\\\ncCoords}[4]{\\n  \\\\def\\\\NCPP{ \
sqrt(#4^2*(#1)^2 + #3^2*(-#4^2 + (#2)^2)) }\\n  \\\\def\\\\NCQQ{ ( \
#4^2*(#1)^2 + #3^2*(#2)^2 ) }\\n  \\\\def\\\\NCRR{ ( #4^2*(#1)^2 + \
#3^2*(-#4^2 + (#2)^2) ) }\\n  \\\\def\\\\Xa{ ((\\\\NCRR)*(#1) + \
#3^2*(\\\\NCPP)*(#2))/(\\\\NCQQ) }\\n  \\\\def\\\\Xb{ ((\\\\NCRR)*(#1) - \
#3^2*(\\\\NCPP)*(#2))/(\\\\NCQQ) }\\n  \\\\def\\\\Ya{ \
(-(#4^2*(\\\\NCPP)*(#1)) + (\\\\NCRR)*(#2))/(\\\\NCQQ) }\\n  \\\\def\\\\Yb{ \
(#4^2*(\\\\NCPP)*(#1) + (\\\\NCRR)*(#2))/(\\\\NCQQ) }\\n}\"\>"], "Output",
 CellChangeTimes->{
  3.76819602407654*^9, {3.7681961157111015`*^9, 3.768196132683931*^9}, 
   3.7681961863480253`*^9, 3.76819637134875*^9, {3.768196425012844*^9, 
   3.768196491500161*^9}, 3.768456312567046*^9, 3.7684566048365593`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1353, 835},
WindowMargins->{{145, Automatic}, {Automatic, 91}},
Magnification:>1.3 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 214, 4, 91, "Section"],
Cell[797, 28, 3725, 63, 43, "Text"],
Cell[CellGroupData[{
Cell[4547, 95, 742, 23, 44, "Input"],
Cell[5292, 120, 531, 13, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5860, 138, 3725, 79, 301, "Input"],
Cell[9588, 219, 4806, 150, 145, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14443, 375, 151, 2, 91, "Section"],
Cell[CellGroupData[{
Cell[14619, 381, 2673, 70, 315, "Input"],
Cell[CellGroupData[{
Cell[17317, 455, 693, 14, 28, "Print"],
Cell[18013, 471, 732, 15, 28, "Print"],
Cell[18748, 488, 533, 8, 28, "Print"]
}, Open  ]],
Cell[19296, 499, 887, 13, 581, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20232, 518, 342, 12, 91, "Section"],
Cell[20577, 532, 1466, 29, 190, "Input"],
Cell[CellGroupData[{
Cell[22068, 565, 3068, 68, 157, "Input"],
Cell[25139, 635, 1469, 37, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26645, 677, 2241, 53, 269, "Input"],
Cell[28889, 732, 798, 11, 240, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
